include /etc/nginx/naxsi/naxsi_core.rules;
include /etc/nginx/naxsi/naxsi_whitelist.rules;

server {
    listen 80;
    server_name localhost;

    location /RequestDenied {
        return 403 "Request blocked by NAXSI";
    }

    location / {
        SecRulesEnabled;
        DeniedUrl "/RequestDenied";

        CheckRule "$SQL >= 8" BLOCK;
        CheckRule "$RFI >= 8" BLOCK;
        CheckRule "$TRAVERSAL >= 4" BLOCK;
        CheckRule "$EVADE >= 4" BLOCK;
        CheckRule "$XSS >= 8" BLOCK;

        proxy_pass http://naxsi-dvwa:80;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}

